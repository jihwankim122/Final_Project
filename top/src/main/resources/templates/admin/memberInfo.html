<!DOCTYPE html>
<html layout:decorate="~{layouts/adminLayout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- 사용자 CSS 추가 -->
<th:block layout:fragment="css">
  <style>
    a {
        text-decoration: none;
    }

    .carousel-inner>.item {
        height: 350px;
    }

    .card {
        height: 450px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    .card img {
        width: 100%;
        height: 300px;
        object-fit: cover;
    }

    .card-body {
        padding: 10px;
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .card-text,
    .card-title {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .margin {
        margin-bottom: 30px;
    }

    .banner {
        height: 300px;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .card-text {
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
        border: none;
    }

    .center {
        text-align: center;
    }

    /* 챗봇 아이콘 스타일 */
    .chatbot-icon {
        position: fixed;
        bottom: 30px;
        right: 30px;
        /* 아이콘을 오른쪽으로 이동 */
        font-size: 40px;
        /* 아이콘 크기 증가 */
        cursor: pointer;
        /* 커서 포인터 추가 */
        background-color: #007bff;
        /* 배경 색 추가 */
        color: white;
        /* 아이콘 색상 */
        border-radius: 50%;
        /* 원형 */
        height: 60px;
        aspect-ratio: 1 / 1;
        padding: 10px;
        /* 여백 추가 */
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        /* 그림자 추가 */
        transition: background-color 0.3s;
        /* 배경 색상 전환 효과 */
    }

    .chatbot-icon:hover {
        background-color: #0056b3;
        /* 호버 시 색상 변경 */
    }

    /* 챗봇 스타일 */
    .chatbot-container {
        display: none;
        /* 기본적으로 숨김 */
        position: fixed;
        bottom: 30px;
        /* 위치 조정 */
        right: 30px;
        width: 300px;
        /* 너비 조정 */
        height: 400px;
        /* 높이 늘리기 */
        background-color: #ffffff;
        /* 배경색 */
        border: 1px solid #ccc;
        /* 테두리 */
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        /* 그림자 */
        border-radius: 8px;
        /* 모서리 둥글게 */
        overflow: hidden;
        /* 내용이 넘치지 않도록 숨김 */
    }

    .chatbot-header {
        background-color: #007bff;
        /* 챗봇 헤더 색상 */
        color: white;
        /* 글자 색상 */
        padding: 10px;
        /* 여백 */
        text-align: center;
        /* 가운데 정렬 */
        border-radius: 8px 8px 0 0;
        /* 모서리 둥글게 */
    }

    .chatbot-body {
        padding: 10px;
        /* 여백 */
        font-size: 16px;
        /* 글씨 크기 늘리기 */
        line-height: 1.6;
        /* 줄 간격 늘리기 */
        height: calc(100% - 95px);
        /* 입력창 크기를 고려한 높이 */
        overflow-y: auto;
        /* 수직 스크롤 가능 */
    }

    .chatbot-input {
        display: flex;
        /* 입력창 정렬 */
        height: 50px;
        padding: 5px;
        /* 여백 */
        border-top: 1px solid #ccc;
        /* 입력창 위쪽에 테두리 추가 */
        background-color: #f9f9f9;
        /* 입력창 배경색 */
    }

    .chatbot-input input {
        flex-grow: 1;
        /* 입력창 확장 */
        padding: 5px;
        /* 여백 */
        border: 1px solid #ccc;
        /* 테두리 */
        border-radius: 5px;
        /* 모서리 둥글게 */
        margin-right: 5px;
        /* 버튼과의 간격 */
    }

    .chatbot-input button {
        padding: 5px 10px;
        /* 버튼 여백 */
        border: none;
        /* 테두리 제거 */
        background-color: #007bff;
        /* 버튼 배경색 */
        color: white;
        /* 버튼 글자색 */
        border-radius: 5px;
        /* 모서리 둥글게 */
        cursor: pointer;
        /* 커서 포인터 */
    }

    .chatbot-input button:hover {
        background-color: #0056b3;
        /* 버튼 호버 색상 */
    }

    .close-button {
        position: absolute;
        top: 5px;
        right: 5px;
        background-color: transparent;
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
    }

    .chatbot-message {
        background-color: #ffffff;
        /* 배경색 */
        border-radius: 10px;
        /* 둥근 모서리 */
        padding: 15px;
        /* 패딩 */
        margin: 10px 0;
        /* 마진 */
        font-size: 18px;
        /* 폰트 크기 */
        line-height: 1.5;
        /* 줄 간격 */
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        /* 그림자 효과 */
    }

    .chatbot-message h3 {
        margin: 0;
        /* 제목 마진 제거 */
        font-size: 20px;
        /* 제목 폰트 크기 */
        color: #007bff;
        /* 제목 색상 */
    }

    .chatbot-message ul {
        padding-left: 20px;
        /* 리스트 왼쪽 패딩 */
    }
  </style>
</th:block>
<head>
  <meta charset="UTF-8">
  <title>Member Information</title>
</head>
<body>
<div layout:fragment="content">
  <h1>전체 회원 정보 조회 및 수정</h1>
  <!-- 성공 메시지 표시 -->
  <div th:if="${successMessage}" class="alert alert-success" role="alert">
    <span th:text="${successMessage}"></span>
  </div>

  <!-- 오류 메시지 표시 -->
  <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
    <span th:text="${errorMessage}"></span>
  </div>
  <form th:action="@{/admin/updateMembers}" method="post" onsubmit="return confirm('저장하시겠습니까?');">
    <table class="table">
      <thead>
      <tr>
        <th>회원번호</th>
        <th>이메일</th>
        <th>회원가입 날짜</th>
        <th>회원정보 수정 날짜</th>
        <th>이름</th>
        <th>권한</th>
        <th>닉네임</th>
        <th>전화번호</th>
        <th>회원 등급변경</th>
        <th>누적 구매 금액</th>

      </tr>
      </thead>
      <tbody>
      <tr th:each="member : ${members}">
        <td th:text="${member.id}"></td>
        <td th:text="${member.email}"></td>
        <td th:text="${#temporals.format(member.regTime, 'yyyy-MM-dd')}"></td>
        <td th:text="${#temporals.format(member.updateTime, 'yyyy-MM-dd')}"></td>
        <td th:text="${member.name}"></td>
        <td th:text="${member.role}"></td>
        <td th:text="${member.nickname}"></td>
        <td th:text="${member.phone}"></td>


        <td>
          <select th:name="'grade_' + ${member.id}">
            <option value="BRONZE" th:selected="${member.grade.name()  == 'BRONZE'}">브론즈</option>
            <option value="SILVER" th:selected="${member.grade.name()  == 'SILVER'}">실버</option>
            <option value="GOLD" th:selected="${member.grade.name()  == 'GOLD'}">골드</option>
            <option value="PLATINUM" th:selected="${member.grade.name()  == 'PLATINUM'}">플래티넘</option>
          </select>
        </td>
        <td th:text="${member.totalSpentAmount} + '원'"></td>

      </tr>
      </tbody>
    </table>
    <button type="submit" class="btn btn-primary">저장</button>
  </form>
</div>
</body>
</html>